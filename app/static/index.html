<!doctype html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Planner Calendar</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=SUIT:wght@400;500;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/static/styles.css?v=20260224-saas-v6-chat-approval" />
</head>

<body>
  <main class="calendar-shell">
    <header class="app-header">
      <div class="header-left">
        <div class="app-brand">AI Planner</div>
        <div class="nav-group">
          <button id="nav-prev" class="btn btn-ghost" type="button">◀</button>
          <button id="nav-today" class="btn btn-ghost" type="button">오늘</button>
          <button id="nav-next" class="btn btn-ghost" type="button">▶</button>
        </div>
        <h1 id="range-title" class="range-title"></h1>
      </div>

      <div class="header-right">
        <div class="compact-field">
          <label for="autonomy">자동화</label>
          <select id="autonomy">
            <option value="L0">L0 관찰</option>
            <option value="L1">L1 제안</option>
            <option value="L2">L2 승인 후 반영</option>
            <option value="L3">L3 자동 반영</option>
            <option value="L4">L4 고도 자동</option>
          </select>
        </div>
        <div class="compact-field">
          <label for="timezone">시간대</label>
          <input id="timezone" type="text" />
        </div>
        <button id="save-profile" class="btn btn-ghost" type="button">저장</button>
        <button id="graph-connect" class="btn btn-primary" type="button">Outlook 연결</button>
        <button id="graph-disconnect" class="btn btn-ghost" type="button">해제</button>
        <button id="sync-bidirectional" class="btn btn-ghost" type="button">동기화</button>
        <span id="graph-status-label" class="status-pill">Graph 미연결</span>
      </div>
    </header>

    <div id="status-message" class="status-line"></div>

    <section class="workspace-grid">
      <aside class="sidebar sidebar-left">
        <section class="panel mini-panel">
          <div class="panel-title-row">
            <button id="mini-prev" class="btn btn-ghost btn-mini" type="button">◀</button>
            <strong id="mini-title"></strong>
            <button id="mini-next" class="btn btn-ghost btn-mini" type="button">▶</button>
          </div>
          <div class="mini-weekdays">
            <span>월</span>
            <span>화</span>
            <span>수</span>
            <span>목</span>
            <span>금</span>
            <span>토</span>
            <span>일</span>
          </div>
          <div id="mini-month" class="mini-month"></div>
        </section>

        <section class="panel quick-task-panel">
          <div class="panel-title-row">
            <strong>빠른 할일 추가</strong>
          </div>
          <form id="task-form" class="stack">
            <input id="task-title" required placeholder="할일 제목" />
            <div class="split">
              <select id="task-priority">
                <option value="medium">중간</option>
                <option value="high">높음</option>
                <option value="critical">긴급</option>
                <option value="low">낮음</option>
              </select>
              <input id="task-due" type="datetime-local" />
            </div>
            <div class="split">
              <input id="task-effort" type="number" min="15" step="15" value="60" />
              <button class="btn btn-primary" type="submit">추가</button>
            </div>
          </form>
        </section>

        <section class="panel today-panel">
          <div class="panel-title-row">
            <strong>오늘 브리핑</strong>
            <button id="refresh-briefing" class="btn btn-ghost btn-mini" type="button">갱신</button>
          </div>
          <div id="today-briefing-date" class="todo-meta"></div>
          <div id="today-briefing-sync" class="todo-meta"></div>
          <div id="today-briefing-snapshot" class="today-snapshot"></div>
          <div class="today-block">
            <div class="today-block-title">Top Tasks</div>
            <div id="today-briefing-top" class="scroll-list today-list"></div>
          </div>
          <div class="today-grid">
            <div class="today-block">
              <div class="today-block-title">리스크</div>
              <div id="today-briefing-risks" class="scroll-list today-list"></div>
            </div>
            <div class="today-block">
              <div class="today-block-title">리마인드</div>
              <div id="today-briefing-reminders" class="scroll-list today-list"></div>
            </div>
          </div>
        </section>

        <section class="panel list-panel">
          <div class="panel-title-row">
            <strong>To-do</strong>
            <button id="sync-todo" class="btn btn-ghost btn-mini" type="button">To Do 가져오기</button>
          </div>
          <div id="todo-list" class="scroll-list"></div>
        </section>

        <section class="panel list-panel">
          <div class="panel-title-row">
            <strong>승인 요청 <span id="approval-count" class="muted"></span></strong>
            <button id="refresh-approvals" class="btn btn-ghost btn-mini" type="button">갱신</button>
          </div>
          <div id="approvals-list" class="scroll-list"></div>
        </section>
      </aside>

      <section class="panel calendar-panel">
        <div id="week-days-header" class="week-days-header"></div>
        <div class="time-grid-wrap">
          <div id="time-labels" class="time-labels"></div>
          <div id="week-columns" class="week-columns"></div>
        </div>
      </section>

      <aside class="sidebar sidebar-right">
        <section class="panel agenda-panel">
          <div class="panel-title-row">
            <strong>일정 리스트</strong>
            <span id="agenda-date" class="muted"></span>
          </div>
          <div id="agenda-list" class="scroll-list"></div>
        </section>
      </aside>
    </section>
  </main>

  <!-- Floating AI Assistant -->
  <button id="chat-fab" class="btn btn-primary chat-fab" type="button"
    onclick="document.getElementById('floating-chat').classList.remove('hidden'); document.getElementById('floating-chat').classList.add('show'); this.style.display='none';">
    💬 AI Assistant
  </button>

  <section id="floating-chat" class="panel chat-panel floating-chat hidden">
    <div class="panel-title-row">
      <strong>AI Assistant</strong>
      <button id="close-chat" class="btn btn-ghost btn-mini" type="button"
        onclick="document.getElementById('floating-chat').classList.remove('show'); document.getElementById('floating-chat').classList.add('hidden'); document.getElementById('chat-fab').style.display='flex';">✕</button>
    </div>
    <div id="chat-log" class="chat-log"></div>
    <div class="chat-prompts">
      <button class="prompt-chip" data-prompt="회의록: PM: 금요일까지 제안서 초안 작성. 디자이너: 목요일 오전 시안 공유">
        회의록 등록
      </button>
      <button class="prompt-chip" data-prompt="이번 주 일정 재배치해줘">일정 재배치</button>
      <button class="prompt-chip" data-prompt="보고서 작업 우선순위 높음으로 변경해줘">우선순위 변경</button>
    </div>
    <form id="chat-form" class="chat-form">
      <textarea id="chat-input" rows="3" placeholder="예: 내일 오전 고객 미팅 준비 작업 추가하고, 보고서 마감은 금요일 오후 5시로 변경해줘"
        required></textarea>
      <button id="chat-send" class="btn btn-primary" type="submit">보내기</button>
    </form>
  </section>

  <!-- Event Edit Modal -->
  <div id="event-modal-overlay" class="event-modal-overlay hidden" onclick="closeEventModal()">
    <div class="event-modal" onclick="event.stopPropagation()">
      <div class="event-modal-header">
        <h3>일정 수정</h3>
        <button class="btn btn-ghost btn-mini" onclick="closeEventModal()" type="button">✕</button>
      </div>
      <form id="event-edit-form" class="event-modal-body" onsubmit="event.preventDefault(); saveEventChanges();">
        <input type="hidden" id="edit-event-id" />
        <div class="form-group">
          <label for="edit-event-title">제목</label>
          <input id="edit-event-title" type="text" required placeholder="일정 제목" />
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="edit-event-start">시작</label>
            <input id="edit-event-start" type="datetime-local" required />
          </div>
          <div class="form-group">
            <label for="edit-event-end">종료</label>
            <input id="edit-event-end" type="datetime-local" required />
          </div>
        </div>
        <div class="event-modal-actions">
          <button type="button" class="btn btn-danger" onclick="deleteFromModal()">삭제</button>
          <div class="modal-actions-right">
            <button type="button" class="btn btn-ghost" onclick="closeEventModal()">취소</button>
            <button type="submit" class="btn btn-primary">저장</button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <script src="/static/app.js?v=20260224-saas-v8-chat-approval"></script>
</body>

</html>
